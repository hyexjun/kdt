# -*- coding: utf-8 -*-
"""exam04_pandas03.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1NYG2evOyy2wZzxNm93RjAPVlGI1v7WRo

# ğŸˆ Apply()
"""

import pandas as pd
import seaborn as sns  # ë°ì´í„° ì˜ˆì œ ë¶ˆëŸ¬ì˜¤ëŠ” ìš©

titanic = sns.load_dataset('titanic')
df = titanic.loc[:, ['age', 'fare']]
# df['fare'] = df['fare'].round(1)
df['ten'] = 10
print(df.head())

# ë°©ë²• 1

def add_5(n) :
  return n + 5

for i in range(len(df)):
  df.iloc[i, 0] = add_5(df.iloc[i, 0])

print(df.age)

# ë°©ë²• 2

sr1 = df['age'].apply(add_5)  # ê°ì²´.apply(ì ìš©í•  í•¨ìˆ˜ëª…)
print(sr1)

# ë°©ë²• 3

sr1 = df['age'].apply(lambda x: x-5)
# ëŒë‹¤ í•¨ìˆ˜ ì´ì œì•¼ ì´í•´ëœ..;; í•¨ìˆ˜ì„ ì–¸ì„ ì•½ì‹ìœ¼ë¡œ ì €ê¸°ë‹¤ê°€..
print(sr1)

"""# ğŸ Concat()"""

df1 = pd.DataFrame({'a':['a0', 'a1', 'a2', 'a3'],
                    'b':['b0', 'b1', 'b2', 'b3'],
                    'c':['c0', 'c1', 'c2', 'c3']}, 
                   index=[0, 1, 2, 3])

df2 = pd.DataFrame({'a':['a2', 'a3', 'a4', 'a5'],
                    'b':['b2', 'b3', 'b4', 'b5'],
                    'c':['c2', 'c3', 'c4', 'c5'],
                    'd':['d2', 'd3', 'd4', 'd5']}, 
                   index=[2, 3, 4, 5])

print(df1)
print(df2)

result1 = df1 + df2
print(result1)  # ê²¹ì¹˜ëŠ” í•­ëª©ë§Œ ë¦¬í„´í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” NaN

result1 = pd.concat([df1, df2])
print(result1)  # ì´ê±´ ê°™ì€ ì¢Œí‘œì—ì„œ ë”í•œë‹¤ê¸°ë³´ë‹¤ ê·¸ëƒ¥ ì´ì–´ë¶™ì´ê¸°..?

result1 = pd.concat([df1, df2], ignore_index=True)  # ê¸°ì¡´ ì¸ë±ìŠ¤ ë¬´ì‹œí•˜ê³  ìƒˆë¡œ ë„˜ë²„ë§
print(result1)

result2 = pd.concat([df1, df2], axis='columns')
print(result2)

result3 = pd.concat([df1, df2], axis='columns', join='inner')
print(result3)

